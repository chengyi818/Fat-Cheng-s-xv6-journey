# LEC20 虚拟机

# 什么是虚拟机?
1. 模拟一台计算机
2. 作为一个应用程序运行在host主机上
3. 准确
4. 独立隔离
5. 性能优良

# 虚拟机的用途
1. 在一台host主机上,运行不同的操作系统
2. 管理大型主机(以OS为粒度,分配CPU和内存)
3. 内核开发环境(比如qemu)
4. 更好地异常错误隔离

# 虚拟机准确性要求
1. 处理不同操作系统内核的奇怪特性
2. 准确复现bugs
3. 处理恶意软件,保证恶意软件不能沙箱逃逸.
4. 目标:
  4.1 运行在虚拟机中的软件无法区分是运行在虚拟机还是真实主机中.
  4.2 运行在虚拟机中的软件无法从虚拟机中逃逸
5. 一些不太好的虚拟机,需要修改guest内核

# 虚拟机的起源
虚拟机是一个很古老的概念.
1. 1960s,IBM使用虚拟机来共享大型计算机.
2. 1990s,VMWare在x86上使得虚拟机重新流行起来.

# 术语
1. VMM: Virtual Machine Monitor,类似host
2. host: 运行虚拟机的主机
3. guest: 运行在主机上的虚拟机程序,包括guest内核及应用程序.
4. 一般虚拟机需要运行在host的操作系统上,host os和vm是独立的.

# VMM的作用
1. 在guest之间分配内存
2. 在guest之间分配CPU时间
3. 为每个guest模拟虚拟硬盘,网络设备等
